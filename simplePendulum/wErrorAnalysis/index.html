<!DOCTYPE html> <title>Simple pendulum Runge-Kutta-Fehlberg solver with error analysis</title> <!--We need a few external JS libraries to provide LaTeX and plot rendering. --> <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <link rel=stylesheet  href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin=anonymous > <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin=anonymous ></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin=anonymous  onload="renderMathInElement(document.body);"></script> <!-- Necessary for analytically finding the period of the problem--> <script src="https://unpkg.com/mathjs@7.1.0/dist/math.min.js"></script> <script src="../wErrorAnalysis.js"></script> <link rel=icon  href="/assets/favicon.png"> <body onload="periodCalc()"> <h1>Simple pendulum problem solver with error analysis</h1> <div> This webpage uses the <a href='https://en.wikipedia.org/wiki/Runge-Kutta-Fehlberg_method' link='_blank'>Runge-Kutta-Fehlberg</a> fourth-order method with fifth-order error checking (RKF45) to approximate the solution to the problem of the simple pendulum: \[ \dfrac{d^2 \theta}{dt^2} = -\dfrac{g}{l} \cos{\theta} \] where \(g\) is the acceleration due to gravity in metres per second squared, \(l\) is the length of the pendulum in metres, \(\theta\) is the angle from the positive \(x\) axis (in radians) and \(t\) is the time in seconds. Below you can specify the various parameters for the problem we will solve. The error in \(\dot{\theta}\) mentioned in the table below is approximated using this formula derived by integrating the above equation: \[ \dot{\theta} = \pm \sqrt{\dot{\theta}_0^2 + \dfrac{2g}{l}\left(\sin{\theta_0} - \sin{\theta}\right)}. \] Our \(\theta\) approximations are substituted in, and our \(\dot{\theta}\) RKF45 approximation is subtracted from this value. From this equation, the period \(T\) of the problem is approximated, namely as: \[ \begin{aligned} T &= 2 \left|\int_{\theta_\mathrm{min}}^{\theta_\mathrm{max}} \dfrac{d\theta}{\sqrt{\dot{\theta}_0^2 + \dfrac{2g}{l} (\sin{\theta_0} - \sin{\theta}})}\right| \end{aligned} \] where \(\theta_\mathrm{min}\) and \(\theta_\mathrm{max}\) are the two closest values for which \(\dot{\theta} = 0\). \(\theta_\mathrm{min}\) and \(\theta_\mathrm{max}\) are calculated using <a href="https://en.wikipedia.org/wiki/Newton's_method" link='_blank'>Newton's method</a> and \(T\) is calculated using <a href='https://en.wikipedia.org/wiki/Chebyshev-Gauss_quadrature' link='_blank'>Chebyshev-Gauss quadrature</a> (Simpson's rule could not be used as there are unremovable singularities at the endpoints). </div> <!--A form for users to enter in all the parameters of the problem--> <form name=requiredData > <table> <tr> <th>Parameter <th>Value <th>Explanation <tr> <td><label for=g >\(g\):</label> <td><input type=Number  id=g  name=g  value=9.81  onsubmit="periodCalc()" onchange="periodCalc()"> <td>Acceleration due to gravity in \(\mathrm{m} \cdot \mathrm{s}^{-2}\). <tr> <td><label for=l >\(l\):</label> <td><input type=Number  id=l  name=l  value=1  onsubmit="periodCalc()" onchange="periodCalc()"> <td>Length of the pendulum rod in metres (m). <tr> <td><label for=t0 >\(t_0\):</label> <td><input type=Number  id=t0  name=t0  value=0 > <td>Starting time for the simulation in seconds (s). <tr> <td><label for=tf >\(t_f\):</label> <td><input type=Number  id=tf  name=tf  value=9.4713677903049498 > <td>End time for the simulation in seconds. The default \(t_f - t_0\) value is equal to four times the period \(T\) of the problem. <tr> <td><label for=theta0 >\(\theta_0\):</label> <td><input type=Number  id=theta0  name=theta0  value=0  onsubmit="periodCalc()" onchange="periodCalc()"> <td>Angle from the positive \(x\)-axis in radians at time \(t_0\). <tr> <td><label for=thetaDot0 >\(\dot{\theta}_0\):</label> <td><input type=Number  id=thetaDot0  name=thetaDot0  value=0  onsubmit="periodCalc()" onchange="periodCalc()"> <td>First derivative of \(\theta\) with respect to \(t\) at \(t_0\) (in \(\mathrm{radians}\cdot \mathrm{s}^{-1}\)). <tr> <td><label for=thetaMaxInitial >Initial guess for \(\max{\theta}\):</label> <td><input type=Number  id=thetaMaxInitial  name=thetaMaxInitial  value=-3.14  onsubmit="periodCalc()" onchange="periodCalc()"> <td>Value of \(\dot{\theta}\) at \(t_0\). <tr> <td><label for=N >\(N\):</label> <td><input type=Number  id=N  name=N  value=1e6  onsubmit="periodCalc()" onchange="periodCalc()"> <td>Number of Chebyshev-Gauss quadrature nodes used to approximate the period of the problem. This is also equal to the maximum number of iterations that can be used to approximate \(\theta_\mathrm{min}\) and \(\theta_\mathrm{max}\). \(N \gt 1e7\) usually freezes up the page. <tr> <td><label for=xi >\(\xi\):</label> <td><input type=Number  id=xi  name=xi  value=1e-12  onsubmit="periodCalc()" onchange="periodCalc()"> <td>Cut off for Newton's method corrections (i.e. once the correction's absolute value dips below this value, the iterations stop). <tr> <td><label for=epsilon >\(\epsilon\):</label> <td><input type=Number  id=epsilon  name=epsilon  value=1e-11 > <td>Error tolerance in both \(\theta\) and \(\dot{\theta}\). \(\epsilon \lt \)2e-12 often freezes the webpage. <tr> <td><label for=dtInitial >dtInitial:</label> <td><input type=Number  id=dtInitial  name=dtInitial  value=0.1 > <td>Initial guess for step size. </table> </form> <br/> <table> <tr> <th>Information <th>Data <th>Notes <tr> <td>\(T\): <td id=integralDisplay > <td>Period of the problem, auto-calculated. <tr> <td><code>adjMin</code> <td id=adjMinDisplay > <td>Last correction to \(\theta_\mathrm{min}\). <tr> <td><code>adjMax</code> <td id=adjMaxDisplay > <td>Last correction to \(\theta_\mathrm{max}\). <tr> <td>\(\theta_\mathrm{min}\) <td id=thetaMinDisplay > <td>The value of \(\theta_\mathrm{min}\) used in the above period equation. <tr> <td>\(\theta_\mathrm{max}\) <td id=thetaMaxDisplay > <td>The value of \(\theta_\mathrm{max}\) used in the above period equation. <tr> <td>\(j\) <td id=jDisplay > <td>Number of iterations used to calculate \(\theta_\mathrm{max}\). <tr> <td>\(k\) <td id=kDisplay > <td>Number of iterations used to calculate \(\theta_\mathrm{min}\). </table> <!--Buttons--> <button type=button  onclick="solveProblem()">Solve the problem</button> (press this whenever you update the parameters above)<br/><br/> <table id=buttontable > <tr> <td><button type=button  onclick="fillTable()">Tabulate the solution</button> <td><button type=button  onclick="removeTable()">Remove the solution table</button> <tr> <td><button type=button  onclick="generatePhasePlot()">Generate phase plot</button> <td><button type=button  onclick="removePhasePlot()">Remove plot</button> <tr> <td><button type=button  onclick="generateTimePlot()">Generate time plot</button> <td><button type=button  onclick="removeTimePlot()">Remove plot</button> <tr> <td><button type=button  onclick="generateErrorPlot()">Generate a semilog plot of the error in \(\dot{\theta}\) against time</button> <td><button type=button  onclick="removeErrorPlot()">Remove plot</button> <tr> <td><button type=button  onclick="generatePlots()">Generate all solution plots</button> <td><button type=button  onclick="removePlots()">Remove all solution plots</button> </table> <!--Where the table and plot goes--> <table id=tableOutputs > </table> <div id='timePlot'></div> <div id='errorPlot'></div> <div id='phasePlot'></div> <style> h1 { font-size: 30px; max-width: 100%; } div { margin: 1px; max-width: 100%; } table, tr, th, td { border: 1px solid black; border-collapse: collapse; max-width: 100%; } td { padding: 2px; } /* Equations are much smaller on mobile devices than the text w/o this */ .katex { font-size: 20px; } #buttontable, #buttontable tr, #buttontable td { border: none; max-width: 100%; } #timePlot, #errorPlot, #phasePlot { width: 100%; } </style>